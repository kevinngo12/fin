!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).Fuse=t()}(this,function(){"use strict";function e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}function t(t){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?e(Object(i),!0).forEach(function(e){c(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):e(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t}function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function o(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");Object.defineProperty(e,"prototype",{value:Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),writable:!1}),t&&u(e,t)}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function h(e){var t=function e(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function n(){var i,r=a(e);if(t){var o=a(this).constructor;i=Reflect.construct(r,arguments,o)}else i=r.apply(this,arguments);return function e(t,n){if(n&&("object"==typeof n||"function"==typeof n))return n;if(void 0!==n)throw TypeError("Derived constructors may only return object or undefined");return function e(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,i)}}function f(e){return function e(t){if(Array.isArray(t))return l(t)}(e)||function e(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(e)||function e(t,n){if(t){if("string"==typeof t)return l(t,n);var i=Object.prototype.toString.call(t).slice(8,-1);if("Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return l(t,n)}}(e)||function e(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);n<t;n++)i[n]=e[n];return i}function d(e){return Array.isArray?Array.isArray(e):"[object Array]"===m(e)}var v=1/0;function g(e){return"string"==typeof e}function p(e){return"number"==typeof e}function y(e){return"object"===n(e)}function $(e){return null!=e}function _(e){return!e.trim().length}function m(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}var k=Object.prototype.hasOwnProperty,M=function(){function e(t){var n=this;i(this,e),this._keys=[],this._keyMap={};var r=0;t.forEach(function(e){var t=x(e);r+=t.weight,n._keys.push(t),n._keyMap[t.id]=t,r+=t.weight}),this._keys.forEach(function(e){e.weight/=r})}return o(e,[{key:"get",value:function e(t){return this._keyMap[t]}},{key:"keys",value:function e(){return this._keys}},{key:"toJSON",value:function e(){return JSON.stringify(this._keys)}}]),e}();function x(e){var t,n=null,i=null,r=null,o=1,c=null;if(g(e)||d(e))r=e,n=L(e),i=b(e);else{if(!k.call(e,"name")){throw Error("Missing ".concat("name"," property in key"))}var s=e.name;if(r=s,k.call(e,"weight")&&(o=e.weight)<=0)throw Error((t=s,"Property 'weight' in key '".concat(t,"' must be a positive integer")));n=L(s),i=b(s),c=e.getFn}return{path:n,id:i,weight:o,src:r,getFn:c}}function L(e){return d(e)?e:e.split(".")}function b(e){return d(e)?e.join("."):e}var w=t(t(t(t({},{isCaseSensitive:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:function e(t,n){return t.score===n.score?t.idx<n.idx?-1:1:t.score<n.score?-1:1}}),{includeMatches:!1,findAllMatches:!1,minMatchCharLength:1}),{location:0,threshold:.6,distance:100}),{useExtendedSearch:!1,getFn:function e(t,n){var i=[],r=!1;return!function e(t,n,o){if($(t)){if(n[o]){var c,s,a,u=t[n[o]];if($(u))if(o===n.length-1&&(g(u)||p(u)||!0===(s=u)||!1===s||(c=s,y(c)&&null!==c&&"[object Boolean]"==m(s))))i.push(null==(a=u)?"":function e(t){if("string"==typeof t)return t;var n=t+"";return"0"==n&&1/t==-v?"-0":n}(a));else if(d(u)){r=!0;for(var h=0,f=u.length;h<f;h+=1)e(u[h],n,o+1)}else n.length&&e(u,n,o+1)}else i.push(t)}}(t,g(n)?n.split("."):n,0),r?i:i[0]},ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1}),S=/[^ ]+/g,A=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.getFn,r=void 0===n?w.getFn:n,o=t.fieldNormWeight,c=void 0===o?w.fieldNormWeight:o;i(this,e),this.norm=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,i=new Map,r=Math.pow(10,n);return{get:function e(n){var o=n.match(S).length;if(i.has(o))return i.get(o);var c=parseFloat(Math.round(1/Math.pow(o,.5*t)*r)/r);return i.set(o,c),c},clear:function e(){i.clear()}}}(c,3),this.getFn=r,this.isCreated=!1,this.setIndexRecords()}return o(e,[{key:"setSources",value:function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.docs=t}},{key:"setIndexRecords",value:function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.records=t}},{key:"setKeys",value:function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.keys=n,this._keysMap={},n.forEach(function(e,n){t._keysMap[e.id]=n})}},{key:"create",value:function e(){var t=this;!this.isCreated&&this.docs.length&&(this.isCreated=!0,g(this.docs[0])?this.docs.forEach(function(e,n){t._addString(e,n)}):this.docs.forEach(function(e,n){t._addObject(e,n)}),this.norm.clear())}},{key:"add",value:function e(t){var n=this.size();g(t)?this._addString(t,n):this._addObject(t,n)}},{key:"removeAt",value:function e(t){this.records.splice(t,1);for(var n=t,i=this.size();n<i;n+=1)this.records[n].i-=1}},{key:"getValueForItemAtKeyId",value:function e(t,n){return t[this._keysMap[n]]}},{key:"size",value:function e(){return this.records.length}},{key:"_addString",value:function e(t,n){if(!(!$(t)||_(t))){var i={v:t,i:n,n:this.norm.get(t)};this.records.push(i)}}},{key:"_addObject",value:function e(t,n){var i=this,r={i:n,$:{}};this.keys.forEach(function(e,n){var o=e.getFn?e.getFn(t):i.getFn(t,e.path);if($(o)){if(d(o))!function(){for(var e=[],t=[{nestedArrIndex:-1,value:o}];t.length;){var c=t.pop(),s=c.nestedArrIndex,a=c.value;if($(a)){if(g(a)&&!_(a)){var u={v:a,i:s,n:i.norm.get(a)};e.push(u)}else d(a)&&a.forEach(function(e,n){t.push({nestedArrIndex:n,value:e})})}}r.$[n]=e}();else if(g(o)&&!_(o)){var c={v:o,n:i.norm.get(o)};r.$[n]=c}}}),this.records.push(r)}},{key:"toJSON",value:function e(){return{keys:this.keys,records:this.records}}}]),e}();function I(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=n.getFn,r=void 0===i?w.getFn:i,o=n.fieldNormWeight,c=void 0===o?w.fieldNormWeight:o,s=new A({getFn:r,fieldNormWeight:c});return s.setKeys(e.map(x)),s.setSources(t),s.create(),s}function C(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.errors,i=t.currentLocation,r=t.expectedLocation,o=t.distance,c=void 0===o?w.distance:o,s=t.ignoreLocation,a=void 0===s?w.ignoreLocation:s,u=(void 0===n?0:n)/e.length;if(a)return u;var h=Math.abs((void 0===r?0:r)-(void 0===i?0:i));return c?u+h/c:h?1:u}var E=function(){function e(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=r.location,c=void 0===o?w.location:o,s=r.threshold,a=void 0===s?w.threshold:s,u=r.distance,h=void 0===u?w.distance:u,f=r.includeMatches,l=void 0===f?w.includeMatches:f,d=r.findAllMatches,v=void 0===d?w.findAllMatches:d,g=r.minMatchCharLength,p=void 0===g?w.minMatchCharLength:g,y=r.isCaseSensitive,$=void 0===y?w.isCaseSensitive:y,_=r.ignoreLocation,m=void 0===_?w.ignoreLocation:_;if(i(this,e),this.options={location:c,threshold:a,distance:h,includeMatches:l,findAllMatches:v,minMatchCharLength:p,isCaseSensitive:$,ignoreLocation:m},this.pattern=$?t:t.toLowerCase(),this.chunks=[],this.pattern.length){var k=function e(t,i){n.chunks.push({pattern:t,alphabet:function e(t){for(var n={},i=0,r=t.length;i<r;i+=1){var o=t.charAt(i);n[o]=(n[o]||0)|1<<r-i-1}return n}(t),startIndex:i})},M=this.pattern.length;if(M>32){for(var x=0,L=M%32,b=M-L;x<b;)k(this.pattern.substr(x,32),x),x+=32;if(L){var S=M-32;k(this.pattern.substr(S),S)}}else k(this.pattern,0)}}return o(e,[{key:"searchIn",value:function e(t){var n=this.options,i=n.isCaseSensitive,r=n.includeMatches;if(i||(t=t.toLowerCase()),this.pattern===t){var o={isMatch:!0,score:0};return r&&(o.indices=[[0,t.length-1]]),o}var c=this.options,s=c.location,a=c.distance,u=c.threshold,h=c.findAllMatches,l=c.minMatchCharLength,d=c.ignoreLocation,v=[],g=0,p=!1;this.chunks.forEach(function(e){var n,i=e.pattern,o=function e(t,n,i){var r,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},c=o.location,s=void 0===c?w.location:c,a=o.distance,u=void 0===a?w.distance:a,h=o.threshold,f=void 0===h?w.threshold:h,l=o.findAllMatches,d=void 0===l?w.findAllMatches:l,v=o.minMatchCharLength,g=void 0===v?w.minMatchCharLength:v,p=o.includeMatches,y=void 0===p?w.includeMatches:p,$=o.ignoreLocation,_=void 0===$?w.ignoreLocation:$;if(n.length>32)throw Error("Pattern length exceeds max of ".concat(32,"."));for(var m=n.length,k=t.length,M=Math.max(0,Math.min(s,k)),x=f,L=M,b=g>1||y,S=b?Array(k):[];(r=t.indexOf(n,L))>-1;)if(x=Math.min(C(n,{currentLocation:r,expectedLocation:M,distance:u,ignoreLocation:_}),x),L=r+m,b)for(var A=0;A<m;)S[r+A]=1,A+=1;L=-1;for(var I=[],E=1,F=m+k,N=1<<m-1,O=0;O<m;O+=1){for(var P=0,R=F;P<R;)C(n,{errors:O,currentLocation:M+R,expectedLocation:M,distance:u,ignoreLocation:_})<=x?P=R:F=R,R=Math.floor((F-P)/2+P);F=R;var j=Math.max(1,M-R+1),W=d?k:Math.min(M+R,k)+m,D=Array(W+2);D[W+1]=(1<<O)-1;for(var T=W;T>=j;T-=1){var z=T-1,K=i[t.charAt(z)];if(b&&(S[z]=+!!K),D[T]=(D[T+1]<<1|1)&K,O&&(D[T]|=(I[T+1]|I[T])<<1|1|I[T+1]),D[T]&N&&(E=C(n,{errors:O,currentLocation:z,expectedLocation:M,distance:u,ignoreLocation:_}))<=x){if(x=E,(L=z)<=M)break;j=Math.max(1,2*M-L)}}if(C(n,{errors:O+1,currentLocation:M,expectedLocation:M,distance:u,ignoreLocation:_})>x)break;I=D}var q={isMatch:L>=0,score:Math.max(.001,E)};if(b){var H=function e(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:w.minMatchCharLength,i=[],r=-1,o=-1,c=0,s=t.length;c<s;c+=1){var a=t[c];a&&-1===r?r=c:a||-1===r||((o=c-1)-r+1>=n&&i.push([r,o]),r=-1)}return t[c-1]&&c-r>=n&&i.push([r,c-1]),i}(S,g);H.length?y&&(q.indices=H):q.isMatch=!1}return q}(t,i,e.alphabet,{location:s+e.startIndex,distance:a,threshold:u,findAllMatches:h,minMatchCharLength:l,includeMatches:r,ignoreLocation:d}),c=o.isMatch,y=o.score,$=o.indices;c&&(p=!0),g+=y,c&&$&&(v=[].concat(f(v),f($)))});var y={isMatch:p,score:p?g/this.chunks.length:1};return p&&r&&(y.indices=v),y}}]),e}(),F=function(){function e(t){i(this,e),this.pattern=t}return o(e,[{key:"search",value:function e(){}}],[{key:"isMultiMatch",value:function e(t){return N(t,this.multiRegex)}},{key:"isSingleMatch",value:function e(t){return N(t,this.singleRegex)}}]),e}();function N(e,t){var n=e.match(t);return n?n[1]:null}var O=function(e){s(n,e);var t=h(n);function n(e){return i(this,n),t.call(this,e)}return o(n,[{key:"search",value:function e(t){var n=t===this.pattern;return{isMatch:n,score:n?0:1,indices:[0,this.pattern.length-1]}}}],[{key:"type",get:function e(){return"exact"}},{key:"multiRegex",get:function e(){return/^="(.*)"$/}},{key:"singleRegex",get:function e(){return/^=(.*)$/}}]),n}(F),P=function(e){s(n,e);var t=h(n);function n(e){return i(this,n),t.call(this,e)}return o(n,[{key:"search",value:function e(t){var n=-1===t.indexOf(this.pattern);return{isMatch:n,score:n?0:1,indices:[0,t.length-1]}}}],[{key:"type",get:function e(){return"inverse-exact"}},{key:"multiRegex",get:function e(){return/^!"(.*)"$/}},{key:"singleRegex",get:function e(){return/^!(.*)$/}}]),n}(F),R=function(e){s(n,e);var t=h(n);function n(e){return i(this,n),t.call(this,e)}return o(n,[{key:"search",value:function e(t){var n=t.startsWith(this.pattern);return{isMatch:n,score:n?0:1,indices:[0,this.pattern.length-1]}}}],[{key:"type",get:function e(){return"prefix-exact"}},{key:"multiRegex",get:function e(){return/^\^"(.*)"$/}},{key:"singleRegex",get:function e(){return/^\^(.*)$/}}]),n}(F),j=function(e){s(n,e);var t=h(n);function n(e){return i(this,n),t.call(this,e)}return o(n,[{key:"search",value:function e(t){var n=!t.startsWith(this.pattern);return{isMatch:n,score:n?0:1,indices:[0,t.length-1]}}}],[{key:"type",get:function e(){return"inverse-prefix-exact"}},{key:"multiRegex",get:function e(){return/^!\^"(.*)"$/}},{key:"singleRegex",get:function e(){return/^!\^(.*)$/}}]),n}(F),W=function(e){s(n,e);var t=h(n);function n(e){return i(this,n),t.call(this,e)}return o(n,[{key:"search",value:function e(t){var n=t.endsWith(this.pattern);return{isMatch:n,score:n?0:1,indices:[t.length-this.pattern.length,t.length-1]}}}],[{key:"type",get:function e(){return"suffix-exact"}},{key:"multiRegex",get:function e(){return/^"(.*)"\$$/}},{key:"singleRegex",get:function e(){return/^(.*)\$$/}}]),n}(F),D=function(e){s(n,e);var t=h(n);function n(e){return i(this,n),t.call(this,e)}return o(n,[{key:"search",value:function e(t){var n=!t.endsWith(this.pattern);return{isMatch:n,score:n?0:1,indices:[0,t.length-1]}}}],[{key:"type",get:function e(){return"inverse-suffix-exact"}},{key:"multiRegex",get:function e(){return/^!"(.*)"\$$/}},{key:"singleRegex",get:function e(){return/^!(.*)\$$/}}]),n}(F),T=function(e){s(n,e);var t=h(n);function n(e){var r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},c=o.location,s=void 0===c?w.location:c,a=o.threshold,u=void 0===a?w.threshold:a,h=o.distance,f=void 0===h?w.distance:h,l=o.includeMatches,d=void 0===l?w.includeMatches:l,v=o.findAllMatches,g=void 0===v?w.findAllMatches:v,p=o.minMatchCharLength,y=void 0===p?w.minMatchCharLength:p,$=o.isCaseSensitive,_=void 0===$?w.isCaseSensitive:$,m=o.ignoreLocation,k=void 0===m?w.ignoreLocation:m;return i(this,n),(r=t.call(this,e))._bitapSearch=new E(e,{location:s,threshold:u,distance:f,includeMatches:d,findAllMatches:g,minMatchCharLength:y,isCaseSensitive:_,ignoreLocation:k}),r}return o(n,[{key:"search",value:function e(t){return this._bitapSearch.searchIn(t)}}],[{key:"type",get:function e(){return"fuzzy"}},{key:"multiRegex",get:function e(){return/^"(.*)"$/}},{key:"singleRegex",get:function e(){return/^(.*)$/}}]),n}(F),z=function(e){s(n,e);var t=h(n);function n(e){return i(this,n),t.call(this,e)}return o(n,[{key:"search",value:function e(t){for(var n,i=0,r=[],o=this.pattern.length;(n=t.indexOf(this.pattern,i))>-1;)i=n+o,r.push([n,i-1]);var c=!!r.length;return{isMatch:c,score:c?0:1,indices:r}}}],[{key:"type",get:function e(){return"include"}},{key:"multiRegex",get:function e(){return/^'"(.*)"$/}},{key:"singleRegex",get:function e(){return/^'(.*)$/}}]),n}(F),K=[O,z,R,j,D,W,P,T],q=K.length,H=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/,J=new Set([T.type,z.type]),U=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.isCaseSensitive,o=void 0===r?w.isCaseSensitive:r,c=n.includeMatches,s=void 0===c?w.includeMatches:c,a=n.minMatchCharLength,u=void 0===a?w.minMatchCharLength:a,h=n.ignoreLocation,f=void 0===h?w.ignoreLocation:h,l=n.findAllMatches,d=void 0===l?w.findAllMatches:l,v=n.location,g=void 0===v?w.location:v,p=n.threshold,y=void 0===p?w.threshold:p,$=n.distance,_=void 0===$?w.distance:$;i(this,e),this.query=null,this.options={isCaseSensitive:o,includeMatches:s,minMatchCharLength:u,findAllMatches:d,ignoreLocation:f,location:g,threshold:y,distance:_},this.pattern=o?t:t.toLowerCase(),this.query=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.split("|").map(function(e){for(var t=e.trim().split(H).filter(function(e){return e&&!!e.trim()}),i=[],r=0,o=t.length;r<o;r+=1){for(var c=t[r],s=!1,a=-1;!s&&++a<q;){var u=K[a],h=u.isMultiMatch(c);h&&(i.push(new u(h,n)),s=!0)}if(!s)for(a=-1;++a<q;){var f=K[a],l=f.isSingleMatch(c);if(l){i.push(new f(l,n));break}}}return i})}(this.pattern,this.options)}return o(e,[{key:"searchIn",value:function e(t){var n=this.query;if(!n)return{isMatch:!1,score:1};var i=this.options,r=i.includeMatches;t=i.isCaseSensitive?t:t.toLowerCase();for(var o=0,c=[],s=0,a=0,u=n.length;a<u;a+=1){var h=n[a];c.length=0,o=0;for(var l=0,d=h.length;l<d;l+=1){var v=h[l],g=v.search(t),p=g.isMatch,y=g.indices,$=g.score;if(p){if(o+=1,s+=$,r){var _=v.constructor.type;J.has(_)?c=[].concat(f(c),f(y)):c.push(y)}}else{s=0,o=0,c.length=0;break}}if(o){var m={isMatch:!0,score:s/o};return r&&(m.indices=c),m}}return{isMatch:!1,score:1}}}],[{key:"condition",value:function e(t,n){return n.useExtendedSearch}}]),e}(),V=[];function B(e,t){for(var n=0,i=V.length;n<i;n+=1){var r=V[n];if(r.condition(e,t))return new r(e,t)}return new E(e,t)}var Q={AND:"$and",OR:"$or"},G={PATH:"$path",PATTERN:"$val"},X=function e(t){return!!(t[Q.AND]||t[Q.OR])},Y=function e(t){return c({},Q.AND,Object.keys(t).map(function(e){return c({},e,t[e])}))};function Z(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=n.auto,r=void 0===i||i;return X(e)||(e=Y(e)),function e(n){var i,o=Object.keys(n),c=!!(i=n)[G.PATH];if(!c&&o.length>1&&!X(n))return e(Y(n));if(!d(s=n)&&y(s)&&!X(s)){var s,a,u=c?n[G.PATH]:o[0],h=c?n[G.PATTERN]:n[u];if(!g(h))throw Error((a=u,"Invalid value for key ".concat(a)));var f={keyId:b(u),pattern:h};return r&&(f.searcher=B(h,t)),f}var l={children:[],operator:o[0]};return o.forEach(function(t){var i=n[t];d(i)&&i.forEach(function(t){l.children.push(e(t))})}),l}(e)}function ee(e,t){var n=e.matches;t.matches=[],$(n)&&n.forEach(function(e){if($(e.indices)&&e.indices.length){var n,i={indices:e.indices,value:e.value};e.key&&(i.key=e.key.src),e.idx>-1&&(i.refIndex=e.idx),t.matches.push(i)}})}function et(e,t){t.score=e.score}var en=function(){function e(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2?arguments[2]:void 0;i(this,e),this.options=t(t({},w),r),this.options.useExtendedSearch,this._keyStore=new M(this.options.keys),this.setCollection(n,o)}return o(e,[{key:"setCollection",value:function e(t,n){if(this._docs=t,n&&!(n instanceof A))throw Error("Incorrect 'index' type");this._myIndex=n||I(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}},{key:"add",value:function e(t){$(t)&&(this._docs.push(t),this._myIndex.add(t))}},{key:"remove",value:function e(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){return!1},n=[],i=0,r=this._docs.length;i<r;i+=1){var o=this._docs[i];t(o,i)&&(this.removeAt(i),i-=1,r-=1,n.push(o))}return n}},{key:"removeAt",value:function e(t){this._docs.splice(t,1),this._myIndex.removeAt(t)}},{key:"getIndex",value:function e(){return this._myIndex}},{key:"search",value:function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.limit,r=void 0===i?-1:i,o=this.options,c=o.includeMatches,s=o.includeScore,a=o.shouldSort,u=o.sortFn,h=o.ignoreFieldNorm,f=g(t)?g(this._docs[0])?this._searchStringList(t):this._searchObjectList(t):this._searchLogical(t);return function e(t,n){var i=n.ignoreFieldNorm,r=void 0===i?w.ignoreFieldNorm:i;t.forEach(function(e){var t=1;e.matches.forEach(function(e){var n=e.key,i=e.norm,o=e.score,c=n?n.weight:null;t*=Math.pow(0===o&&c?Number.EPSILON:o,(c||1)*(r?1:i))}),e.score=t})}(f,{ignoreFieldNorm:h}),a&&f.sort(u),p(r)&&r>-1&&(f=f.slice(0,r)),function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=i.includeMatches,o=void 0===r?w.includeMatches:r,c=i.includeScore,s=void 0===c?w.includeScore:c,a=[];return o&&a.push(ee),s&&a.push(et),t.map(function(e){var t=e.idx,i={item:n[t],refIndex:t};return a.length&&a.forEach(function(t){t(e,i)}),i})}(f,this._docs,{includeMatches:c,includeScore:s})}},{key:"_searchStringList",value:function e(t){var n=B(t,this.options),i=this._myIndex.records,r=[];return i.forEach(function(e){var t=e.v,i=e.i,o=e.n;if($(t)){var c=n.searchIn(t),s=c.isMatch,a=c.score,u=c.indices;s&&r.push({item:t,idx:i,matches:[{score:a,value:t,norm:o,indices:u}]})}}),r}},{key:"_searchLogical",value:function e(t){var n=this,i=Z(t,this.options),r=function e(t,i,r){if(!t.children){var o=t.keyId,c=t.searcher,s=n._findMatches({key:n._keyStore.get(o),value:n._myIndex.getValueForItemAtKeyId(i,o),searcher:c});return s&&s.length?[{idx:r,item:i,matches:s}]:[]}for(var a=[],u=0,h=t.children.length;u<h;u+=1){var l=e(t.children[u],i,r);if(l.length)a.push.apply(a,f(l));else if(t.operator===Q.AND)return[]}return a},o=this._myIndex.records,c={},s=[];return o.forEach(function(e){var t=e.$,n=e.i;if($(t)){var o=r(i,t,n);o.length&&(c[n]||(c[n]={idx:n,item:t,matches:[]},s.push(c[n])),o.forEach(function(e){var t,i=e.matches;(t=c[n].matches).push.apply(t,f(i))}))}}),s}},{key:"_searchObjectList",value:function e(t){var n=this,i=B(t,this.options),r=this._myIndex,o=r.keys,c=r.records,s=[];return c.forEach(function(e){var t=e.$,r=e.i;if($(t)){var c=[];o.forEach(function(e,r){c.push.apply(c,f(n._findMatches({key:e,value:t[r],searcher:i})))}),c.length&&s.push({idx:r,item:t,matches:c})}}),s}},{key:"_findMatches",value:function e(t){var n=t.key,i=t.value,r=t.searcher;if(!$(i))return[];var o=[];if(d(i))i.forEach(function(e){var t=e.v,i=e.i,c=e.n;if($(t)){var s=r.searchIn(t),a=s.isMatch,u=s.score,h=s.indices;a&&o.push({score:u,key:n,value:t,idx:i,norm:c,indices:h})}});else{var c=i.v,s=i.n,a=r.searchIn(c),u=a.isMatch,h=a.score,f=a.indices;u&&o.push({score:h,key:n,value:c,norm:s,indices:f})}return o}}]),e}();return en.version="6.6.2",en.createIndex=I,en.parseIndex=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.getFn,r=void 0===i?w.getFn:i,o=n.fieldNormWeight,c=void 0===o?w.fieldNormWeight:o,s=t.keys,a=t.records,u=new A({getFn:r,fieldNormWeight:c});return u.setKeys(s),u.setIndexRecords(a),u},en.config=w,en.parseQuery=Z,!function e(){V.push.apply(V,arguments)}(U),en});